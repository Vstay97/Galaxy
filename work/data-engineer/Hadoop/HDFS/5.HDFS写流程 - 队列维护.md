---
title: HDFS写流程 - 队列维护 ⭐️⭐️
description: HDFS写流程 - 队列维护
keywords:
- HDFS
tags:
- HDFS
sidebar_position: 5
author: Vstay
date: 2025-10-11 15:48
last_update:
  author: Vstay
  date: 2025-10-11
---

单个包数据发送：

1.  数据包（packate）初始状态存放在data队列中；

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143151.png)

2\. Client发送到DN1节点，并且同步将数据拷贝一份到ACK队列【下图右】

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143152.png)

3\. 数据发送到DN1后，data队列删除数据

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143153.png)

4\. 数据按照管道流DN1-DN2-DN3依次发送，并获取ACK确认

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143154.png)

5\. ACK如果判断正确，丢弃数据；

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143155.png)

6.ACK判定失败，则放到data队列末尾

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143156.png)

7.多并发发送：实际过程中，packate的发送，接收是并发执行的。在整个链路中，同时进行很多pacate的传输。单个传输流畅如上1-6

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143157.png)

![](https://cdn.jsdelivr.net/gh/Vstay97/Img_storage@main/blog/2025/HDFS%E5%86%99%E6%B5%81%E7%A8%8B-%E9%98%9F%E5%88%97%E7%BB%B4%E6%8A%A4/20251011155143158.png)